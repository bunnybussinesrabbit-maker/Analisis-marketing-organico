<!DOCTYPE html>
<html>
<head>
    <title>SIMPLE TEST</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f0f0f0;
        }
        .test {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid blue;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background: blue;
            color: white;
            border: none;
            border-radius: 4px;
        }
        .output {
            background: #fffacd;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
        }
        pre {
            margin: 0;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

<h1>üîç SIMPLE TEST - Check Navigation</h1>

<div class="test">
    <h2>1. Check if iframe loads</h2>
    <button onclick="checkIframeLoad()">Check iframe</button>
    <div class="output" id="out1"></div>
</div>

<div class="test">
    <h2>2. Check showView function</h2>
    <button onclick="checkFunction()">Check showView()</button>
    <div class="output" id="out2"></div>
</div>

<div class="test">
    <h2>3. Try navigation</h2>
    <button onclick="tryNav('dashboard')">Nav to dashboard</button>
    <button onclick="tryNav('data')">Nav to data</button>
    <button onclick="tryNav('zones')">Nav to zones</button>
    <div class="output" id="out3"></div>
</div>

<div class="test">
    <h2>4. Check what's happening</h2>
    <button onclick="detailedCheck()">Detailed check</button>
    <div class="output" id="out4"></div>
</div>

<hr>

<h2>üñ•Ô∏è LIVE APP</h2>
<iframe id="app" src="http://localhost:8080/index.html" style="width: 100%; height: 700px; border: 2px solid blue;"></iframe>

<script>
let app;

function out(id, text) {
    document.getElementById(id).innerHTML += '<pre>' + text + '</pre>';
}

function clearOut(id) {
    document.getElementById(id).innerHTML = '';
}

window.addEventListener('load', () => {
    app = document.getElementById('app').contentWindow;
    out('out1', '‚úÖ Ready - iframe should be loading');
});

function checkIframeLoad() {
    clearOut('out1');
    
    if (!app) {
        out('out1', '‚ùå app not ready');
        return;
    }
    
    out('out1', '‚úÖ app object exists');
    out('out1', '‚úÖ Can access iframe window');
    
    setTimeout(() => {
        try {
            const doc = app.document;
            const sections = doc.querySelectorAll('.view-section');
            out('out1', '‚úÖ Found ' + sections.length + ' sections');
            
            const buttons = doc.querySelectorAll('.dashboard-nav-item');
            out('out1', '‚úÖ Found ' + buttons.length + ' buttons');
        } catch (e) {
            out('out1', '‚ùå ' + e.message);
        }
    }, 500);
}

function checkFunction() {
    clearOut('out2');
    
    if (!app) {
        out('out2', '‚ùå app not ready');
        return;
    }
    
    if (typeof app.showView === 'function') {
        out('out2', '‚úÖ showView() EXISTS');
        out('out2', 'Type: ' + typeof app.showView);
    } else {
        out('out2', '‚ùå showView() NOT FOUND');
        out('out2', 'Available: ' + Object.keys(app).slice(0, 10).join(', '));
    }
}

function tryNav(id) {
    clearOut('out3');
    out('out3', 'Attempting navigation to: ' + id);
    
    if (!app) {
        out('out3', '‚ùå app not ready');
        return;
    }
    
    if (typeof app.showView !== 'function') {
        out('out3', '‚ùå showView is not a function');
        return;
    }
    
    try {
        app.showView(id);
        out('out3', '‚úÖ showView("' + id + '") called successfully');
        out('out3', 'Check the iframe above - it should show the ' + id + ' section');
    } catch (e) {
        out('out3', '‚ùå ERROR: ' + e.message);
    }
}

function detailedCheck() {
    clearOut('out4');
    
    if (!app) {
        out('out4', '‚ùå app not ready');
        return;
    }
    
    // Check 1: document
    out('out4', '=== STRUCTURE CHECK ===');
    out('out4', '‚úì window accessible');
    out('out4', '‚úì document accessible');
    
    const doc = app.document;
    
    // Check 2: sections
    const sections = doc.querySelectorAll('.view-section');
    out('out4', '\nSections found: ' + sections.length);
    sections.forEach((s, i) => {
        out('out4', '  ' + (i+1) + '. ' + s.id + ' (active: ' + s.classList.contains('active') + ')');
    });
    
    // Check 3: buttons
    const buttons = doc.querySelectorAll('.dashboard-nav-item');
    out('out4', '\nButtons found: ' + buttons.length);
    buttons.forEach((b, i) => {
        out('out4', '  ' + (i+1) + '. ' + b.getAttribute('data-view'));
    });
    
    // Check 4: functions
    out('out4', '\nFunctions:');
    out('out4', '  showView: ' + (typeof app.showView === 'function' ? '‚úÖ' : '‚ùå'));
    out('out4', '  updateDashboardNavIndicator: ' + (typeof app.updateDashboardNavIndicator === 'function' ? '‚úÖ' : '‚ùå'));
    
    // Check 5: try a click
    out('out4', '\n=== ATTEMPTING MANUAL CLICK ===');
    const firstBtn = buttons[0];
    if (firstBtn) {
        out('out4', 'First button: ' + firstBtn.getAttribute('data-view'));
        out('out4', 'Triggering click...');
        firstBtn.click();
        out('out4', '‚úÖ Click dispatched');
    }
}
</script>

</body>
</html>
