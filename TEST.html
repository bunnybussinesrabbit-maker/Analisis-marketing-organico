<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSTANT TEST - Navigation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: #0a0e27;
            color: #0ff;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            color: #0f0;
            margin-bottom: 20px;
            text-align: center;
            font-size: 24px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .panel {
            background: #1a1a2e;
            border: 2px solid #0ff;
            border-radius: 8px;
            padding: 15px;
        }
        .panel h2 {
            color: #0f0;
            font-size: 14px;
            margin-bottom: 10px;
            border-bottom: 1px solid #0ff;
            padding-bottom: 5px;
        }
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 8px 15px;
            margin: 5px;
            cursor: pointer;
            font-weight: bold;
            border-radius: 4px;
        }
        button:hover {
            background: #00ff00;
            box-shadow: 0 0 10px #0f0;
        }
        .console {
            background: #000;
            border: 1px solid #0f0;
            border-radius: 4px;
            padding: 10px;
            height: 200px;
            overflow-y: auto;
            font-size: 11px;
            margin-top: 10px;
        }
        .log-entry {
            margin: 3px 0;
        }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        .info { color: #0ff; }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 2px solid #0f0;
            border-radius: 4px;
            background: #fff;
        }
        .fullwidth {
            grid-column: 1 / -1;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üî• INSTANT NAVIGATION TEST</h1>
    
    <div class="grid">
        <!-- PANEL 1: Quick Tests -->
        <div class="panel">
            <h2>‚ö° QUICK TESTS</h2>
            <div class="button-group">
                <button onclick="testShowViewFunction()">Test showView()</button>
                <button onclick="testButtons()">Test Buttons</button>
                <button onclick="testSections()">Test Sections</button>
                <button onclick="checkConsole()">Check Errors</button>
            </div>
            <div class="console" id="console1"></div>
        </div>

        <!-- PANEL 2: Manual Navigation -->
        <div class="panel">
            <h2>üéØ MANUAL NAVIGATION</h2>
            <div class="button-group">
                <button onclick="navTo('dashboard')">üìä Dashboard</button>
                <button onclick="navTo('map-section')">üó∫Ô∏è Map</button>
                <button onclick="navTo('data')">üíæ Data</button>
                <button onclick="navTo('analysis')">üìà Analysis</button>
            </div>
            <div class="button-group">
                <button onclick="navTo('zones')">üìç Zones</button>
                <button onclick="navTo('pitch')">üì¢ Pitch</button>
                <button onclick="navTo('routes')">üõ£Ô∏è Routes</button>
                <button onclick="navTo('tools')">üõ†Ô∏è Tools</button>
            </div>
            <div class="button-group">
                <button onclick="navTo('reports')">üìã Reports</button>
                <button onclick="navTo('settings')">‚öôÔ∏è Settings</button>
            </div>
            <div class="console" id="console2"></div>
        </div>
    </div>

    <!-- IFRAME -->
    <div class="panel fullwidth">
        <h2>üñ•Ô∏è APPLICATION PREVIEW</h2>
        <iframe id="appFrame" src="http://localhost:8080/index.html"></iframe>
    </div>
</div>

<script>
let iframe;
let iframeWindow;

function getConsole(num) {
    return document.getElementById('console' + num);
}

function log(num, text, type = 'info') {
    const console_el = getConsole(num);
    const entry = document.createElement('div');
    entry.className = 'log-entry ' + type;
    entry.textContent = '> ' + text;
    console_el.appendChild(entry);
    console_el.scrollTop = console_el.scrollHeight;
}

function clearConsole(num) {
    getConsole(num).innerHTML = '';
}

// Wait for iframe to load
window.addEventListener('load', () => {
    iframe = document.getElementById('appFrame');
    iframeWindow = iframe.contentWindow;
    log(1, '‚úÖ iframe loaded', 'success');
});

function testShowViewFunction() {
    clearConsole(1);
    log(1, 'Testing showView() function...', 'info');
    
    if (!iframeWindow) {
        log(1, '‚ùå iframe not loaded yet', 'error');
        return;
    }
    
    if (typeof iframeWindow.showView !== 'function') {
        log(1, '‚ùå showView is NOT a function', 'error');
        log(1, 'Type: ' + typeof iframeWindow.showView, 'error');
        return;
    }
    
    log(1, '‚úÖ showView() is a function', 'success');
    log(1, 'Calling: showView("dashboard")', 'info');
    
    try {
        iframeWindow.showView('dashboard');
        log(1, '‚úÖ Call executed without errors', 'success');
    } catch (error) {
        log(1, '‚ùå ERROR: ' + error.message, 'error');
    }
}

function testButtons() {
    clearConsole(1);
    log(1, 'Testing button structure...', 'info');
    
    if (!iframeWindow) {
        log(1, '‚ùå iframe not loaded', 'error');
        return;
    }
    
    const buttons = iframeWindow.document.querySelectorAll('.dashboard-nav-item');
    log(1, '‚úÖ Found ' + buttons.length + ' buttons', 'success');
    
    buttons.forEach((btn, i) => {
        const id = btn.getAttribute('data-view');
        const onclick = btn.getAttribute('onclick');
        log(1, (i+1) + '. ' + id + ' (onclick: ' + (onclick ? 'yes' : 'no') + ')', 'info');
    });
}

function testSections() {
    clearConsole(1);
    log(1, 'Testing section structure...', 'info');
    
    if (!iframeWindow) {
        log(1, '‚ùå iframe not loaded', 'error');
        return;
    }
    
    const sections = iframeWindow.document.querySelectorAll('.view-section');
    log(1, '‚úÖ Found ' + sections.length + ' sections', 'success');
    
    sections.forEach((sec, i) => {
        const id = sec.getAttribute('id');
        const active = sec.classList.contains('active');
        log(1, (i+1) + '. #' + id + ' (active: ' + (active ? 'yes' : 'no') + ')', 'info');
    });
}

function checkConsole() {
    clearConsole(1);
    log(1, 'Checking browser console for errors...', 'info');
    log(1, 'Open DevTools (F12) in the iframe and check:');
    log(1, '1. Go to Console tab', 'info');
    log(1, '2. Look for red error messages', 'warning');
    log(1, '3. Look for green debug logs', 'success');
    log(1, '', 'info');
    log(1, 'Green logs you should see:', 'info');
    log(1, '  üîÑ ===== showView() CALLED =====', 'success');
    log(1, '  ‚úÖ Navigation listeners configurados', 'success');
}

function navTo(viewId) {
    clearConsole(2);
    log(2, 'Navigating to: ' + viewId, 'info');
    
    if (!iframeWindow) {
        log(2, '‚ùå iframe not loaded', 'error');
        return;
    }
    
    if (typeof iframeWindow.showView !== 'function') {
        log(2, '‚ùå showView() not found', 'error');
        return;
    }
    
    try {
        iframeWindow.showView(viewId);
        log(2, '‚úÖ Navigation called', 'success');
        log(2, 'Check iframe to see if section changed', 'info');
    } catch (error) {
        log(2, '‚ùå ERROR: ' + error.message, 'error');
    }
}
</script>

</body>
</html>
